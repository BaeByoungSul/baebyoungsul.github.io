import{Aa as o,Ab as P,Ba as d,Cb as Z,Db as R,Eb as p,Fb as T,Gb as $,Hb as x,I as y,Ia as F,Ib as g,Ja as u,Jb as G,Kb as N,Lb as oe,Mb as B,Qb as A,Ua as l,Va as f,Wa as S,bb as C,cb as v,cc as O,dc as D,ea as a,ec as V,fc as j,gc as q,hc as ee,i as M,ic as k,jc as U,jd as H,la as h,na as E,oa as w,pb as b,qb as re,qd as W,rd as X,sb as I,sd as Y,td as z,ua as s,va as m,vd as ne,ya as _,z as ie,za as n,zb as L}from"./chunk-BUOXHOFD.js";function ge(t,i){if(t&1&&(n(0,"mat-error"),l(1),o()),t&2){let e=u();a(),f(e.getErrorMsg("email"))}}function he(t,i){if(t&1&&(n(0,"mat-error"),l(1),o()),t&2){let e=u();a(),f(e.getErrorMsg("password"))}}function Ce(t,i){t&1&&(n(0,"mat-icon"),d(1,"mat-spinner",10),o())}function ve(t,i){if(t&1&&(d(0,"p"),n(1,"div",11),l(2),o()),t&2){let e=u();a(2),S(" ",e.serverError," ")}}function xe(t,i){t&1&&(d(0,"div"),n(1,"pre"),l(2),C(3,"json"),o()),t&2&&(a(2),f(v(3,1,i)))}var J=class t{constructor(i,e){this.authService$=i;this.router$=e;this.currentUser$=this.authService$.user$}loading$=new M(!1);serverError=null;currentUser$;myform=new x({email:new g("",[p.required,p.email]),password:new g("",[p.required])});ngOnInit(){this.authService$.isLoggedIn().pipe(ie(1)).subscribe(i=>{i&&this.router$.navigate(["/home/memo-viewer"],{skipLocationChange:!0})})}onSignIn(){if(this.myform.invalid){this.serverError="form is invalid!";return}this.loading$.next(!0);let i=this.myform.value;this.authService$.signIn(i.email,i.password).then(()=>{console.log("\uB85C\uADF8\uC778 \uC131\uACF5"),this.router$.navigate(["/home/memo-viewer"],{skipLocationChange:!0}),this.loading$.next(!1)}).catch(e=>{this.serverError=e,this.loading$.next(!1)})}onSignInWithGoogle(){this.authService$.signInWithGoogle().then(()=>console.log("Google \uB85C\uADF8\uC778 \uC131\uACF5")).catch(i=>console.error("Google \uB85C\uADF8\uC778 \uC2E4\uD328:",i))}onLogout(){this.authService$.logout().then(()=>console.log("\uB85C\uADF8\uC544\uC6C3 \uC131\uACF5")).catch(i=>console.error("\uB85C\uADF8\uC544\uC6C3 \uC2E4\uD328:",i))}getErrorMsg(i){let e=this.myform.get(i);var r,c;return e?.hasError("maxlength")&&(r=e.errors?.maxlength.requiredLength),e?.hasError("minlength")&&(r=e.errors?.minlength.requiredLength),e?.hasError("required")?"This field is required ":e?.hasError("pattern")?"This field needs to be at least nine characters, one uppercase letter and at least 1 symbol":e?.hasError("email")?"Not a valid email":e?.hasError("minlength")?`This field must be at least ${c} characters long `:e?.hasError("maxlength")?`This field can be max ${r} characters long.`:""}static \u0275fac=function(e){return new(e||t)(h(H),h(L))};static \u0275cmp=E({type:t,selectors:[["app-login"]],decls:26,vars:10,consts:[[1,"top-container"],[1,"input-container"],[3,"ngSubmit","formGroup"],["appearance","outline","floatLabel","always"],["matInput","","type","email","placeholder","Enter your email","formControlName","email"],["matInput","","type","password","placeholder","Enter your password","formControlName","password"],[1,"button-container"],["mat-raised-button","","color","primary"],[2,"flex-grow","1"],["routerLink","../register","skipLocationChange","true"],["color","accent","diameter","20"],[1,"alert","alert-danger"]],template:function(e,r){if(e&1&&(n(0,"div",0)(1,"fieldset",1)(2,"legend"),l(3,"\uB85C\uADF8\uC778 \uC815\uBCF4"),o(),n(4,"form",2),F("ngSubmit",function(){return r.onSignIn()}),n(5,"mat-form-field",3)(6,"mat-label"),l(7,"Email"),o(),d(8,"input",4),s(9,ge,2,1,"mat-error"),o(),n(10,"mat-form-field",3)(11,"mat-label"),l(12,"Password"),o(),d(13,"input",5),s(14,he,2,1,"mat-error"),o(),n(15,"div",6)(16,"button",7),l(17,"Login "),s(18,Ce,2,0,"mat-icon"),C(19,"async"),o(),d(20,"span",8),n(21,"a",9),l(22,"Register"),o()(),s(23,ve,3,1),o()()(),s(24,xe,4,3),C(25,"async")),e&2){let c;a(4),_("formGroup",r.myform),a(5),m(r.myform.controls.email.invalid?9:-1),a(5),m(r.myform.controls.password.invalid?14:-1),a(4),m(v(19,6,r.loading$)?18:-1),a(5),m(r.serverError?23:-1),a(),m((c=v(25,8,r.currentUser$))?24:-1,c)}},dependencies:[D,O,U,k,q,V,j,X,W,z,Y,A,G,R,T,$,N,B,P,b,re],styles:[".top-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:center;align-items:start}.input-container[_ngcontent-%COMP%]{margin-top:100px;padding:20px;width:500px;border:1px solid lightgray;border-radius:5px;display:flex;flex-direction:column;gap:10px}form[_ngcontent-%COMP%]{display:flex;flex-direction:column}form[_ngcontent-%COMP%] > .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end}"]})};function Me(t,i){if(t&1&&(n(0,"mat-error"),l(1),o()),t&2){let e=u();a(),f(e.getErrorMsg("email"))}}function ye(t,i){if(t&1&&(n(0,"mat-error"),l(1),o()),t&2){let e=u();a(),f(e.getErrorMsg("passwordGroup.password"))}}function Ee(t,i){if(t&1&&(n(0,"mat-error"),l(1),o()),t&2){let e=u();a(),f(e.getErrorMsg("passwordGroup.confirmPassword"))}}function we(t,i){t&1&&(n(0,"mat-error"),l(1,"Passwords must match"),o())}function _e(t,i){t&1&&(n(0,"mat-icon"),d(1,"mat-spinner",12),o())}function Fe(t,i){t&1&&(n(0,"h2"),l(1,"\uC815\uC0C1\uC801\uC73C\uB85C \uB4F1\uB85D\uC774 \uB418\uC5C8\uC2B5\uB2C8\uB2E4."),o(),n(2,"h3"),l(3,"\uC774\uBA54\uC77C\uC744 \uD655\uC778\uD558\uC5EC \uBA54\uC77C \uB0B4\uC6A9\uC5D0 \uC788\uB294 \uB9C1\uD06C\uB97C \uD074\uB9AD\uD574\uC8FC\uC138\uC694"),o())}function Se(t,i){if(t&1&&(d(0,"p"),n(1,"div",13),l(2),o()),t&2){let e=u();a(2),S(" ",e.errorMessage," ")}}var K=class t{constructor(i,e){this.authService$=i;this.router$=e}loading$=new M(!1);isSubmitOk=!1;errorMessage="";myForm=new x({email:new g("",[p.required,p.email]),passwordGroup:new x({password:new g("",[p.required,p.minLength(6),p.maxLength(12)]),confirmPassword:new g("",[p.required])},{validators:this.matchValidator})});onSubmit(){if(this.errorMessage="",this.myForm.invalid){this.errorMessage="form is invalid!";return}this.loading$.next(!0);let i=this.myForm.value,e=this.myForm.controls.email.value,r=this.myForm.controls.passwordGroup.controls.password.value;if(!e){this.errorMessage="email is invalid!";return}if(!r){this.errorMessage="password is invalid!";return}this.authService$.signUp(e,r).then(()=>{console.log("\uB85C\uADF8\uC778 \uC131\uACF5"),this.router$.navigate(["/home/memo-viewer"],{skipLocationChange:!0}),this.loading$.next(!1)}).catch(c=>{this.errorMessage=c,this.loading$.next(!1)})}matchValidator(){return i=>{let e=i.get("password"),r=i.get("confirmPassword");return e&&r&&e.value!==r.value?{mustMatch:!0}:null}}getErrorMsg(i){let e=this.myForm.get(i);var r,c;return e?.hasError("maxlength")&&(r=e.errors?.maxlength.requiredLength),e?.hasError("minlength")&&(r=e.errors?.minlength.requiredLength),e?.hasError("required")?"This field is required ":e?.hasError("pattern")?"This field needs to be at least nine characters, one uppercase letter and at least 1 symbol":e?.hasError("email")||e?.hasError("email")?"Not a valid email":e?.hasError("minlength")?`This field must be at least ${c} characters long `:e?.hasError("maxlength")?`This field can be max ${r} characters long.`:""}static \u0275fac=function(e){return new(e||t)(h(H),h(L))};static \u0275cmp=E({type:t,selectors:[["app-register"]],decls:32,vars:10,consts:[[1,"top-container"],[1,"input-container"],[3,"ngSubmit","formGroup"],["appearance","outline","floatLabel","always"],["matInput","","placeholder","Enter your email","formControlName","email"],["formGroupName","passwordGroup",1,"password-container"],["matInput","","type","password","placeholder","Enter your password","formControlName","password"],["matInput","","type","password","placeholder","Enter your confirm password","formControlName","confirmPassword"],[1,"button-container"],["mat-raised-button","","color","primary"],[2,"flex-grow","1"],["routerLink","../login","skipLocationChange","true"],["color","accent","diameter","20"],[1,"alert","alert-danger"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"fieldset",1)(2,"legend"),l(3,"\uC0AC\uC6A9\uC790 \uC815\uBCF4"),o(),n(4,"form",2),F("ngSubmit",function(){return r.onSubmit()}),n(5,"mat-form-field",3)(6,"mat-label"),l(7,"Email"),o(),d(8,"input",4),s(9,Me,2,1,"mat-error"),o(),n(10,"div",5)(11,"mat-form-field",3)(12,"mat-label"),l(13,"Password"),o(),d(14,"input",6),s(15,ye,2,1,"mat-error"),o(),n(16,"mat-form-field",3)(17,"mat-label"),l(18,"Password"),o(),d(19,"input",7),s(20,Ee,2,1,"mat-error"),o(),s(21,we,2,0,"mat-error"),o(),n(22,"div",8)(23,"button",9),l(24,"Register "),s(25,_e,2,0,"mat-icon"),C(26,"async"),o(),d(27,"span",10),n(28,"a",11),l(29,"Cancel"),o()(),s(30,Fe,4,0),s(31,Se,3,1),o()()()),e&2&&(a(4),_("formGroup",r.myForm),a(5),m(r.myForm.controls.email.invalid?9:-1),a(6),m(r.myForm.controls.passwordGroup.controls.password.invalid?15:-1),a(5),m(r.myForm.controls.passwordGroup.controls.confirmPassword.invalid?20:-1),a(),m(r.myForm.controls.passwordGroup.invalid&&r.myForm.controls.passwordGroup.hasError("mustMatch")&&r.myForm.controls.passwordGroup.controls.confirmPassword.dirty&&(r.myForm.controls.passwordGroup.dirty||r.myForm.controls.passwordGroup.touched)?21:-1),a(4),m(v(26,8,r.loading$)?25:-1),a(5),m(r.isSubmitOk?30:-1),a(),m(r.errorMessage?31:-1))},dependencies:[I,P,A,G,R,T,$,N,B,oe,ee,q,V,j,U,k,X,W,z,Y,D,O,b],styles:[".top-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:center;align-items:start}.input-container[_ngcontent-%COMP%]{margin-top:100px;padding:20px;width:500px;border:1px solid lightgray;border-radius:5px;display:flex;flex-direction:column;gap:10px}button[_ngcontent-%COMP%]{width:120px}form[_ngcontent-%COMP%]{display:flex;flex-direction:column}form[_ngcontent-%COMP%] > .password-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}form[_ngcontent-%COMP%] > .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end}"]})};var be=[{path:"",component:ne,children:[{path:"login",component:J},{path:"register",component:K}]}],Q=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=w({type:t});static \u0275inj=y({imports:[Z.forChild(be),Z]})};var ae=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=w({type:t});static \u0275inj=y({imports:[I,Q]})};export{ae as AuthModule};
